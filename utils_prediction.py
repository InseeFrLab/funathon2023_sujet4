import pandas as pd

def extract_predict_fasttext(model, data: pd.DataFrame,
                             feature_var: str,
                             newcols: str = None) -> pd.DataFrame :
    """

    Parameters
    ----------
    model: Fasttext model
    data: Pandas DataFrame that should be used as test dataset
    feature_var: Feature variable name
    newcols: How to name the new variables generated by fasttext. Default to `['prediction', 'proba', 'confiance']`

    Returns
    -------

    """

    if newcols is None:
        newcols = ['prediction', 'proba', 'confiance']

    data[newcols] = pd.DataFrame(
        data[feature_var].astype(str).apply(lambda x: model.predict(x, k=2))
            .apply(lambda l: [l[0][0], l[1][0]]).tolist(), columns=newcols
    )
    data[newcols[0]] = data[newcols[0]].str.replace("__label__", "")
    data[newcols[1:]] = data[newcols[1:]].astype(float)
    return data
